var J=(r,e,t)=>{if(!e.has(r))throw TypeError("Cannot "+t)};var u=(r,e,t)=>(J(r,e,"read from private field"),t?t.call(r):e.get(r)),T=(r,e,t)=>{if(e.has(r))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(r):e.set(r,t)},N=(r,e,t,a)=>(J(r,e,"write to private field"),a?a.call(r,t):e.set(r,t),t);var Y=(r,e,t)=>(J(r,e,"access private method"),t);const fe=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function t(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerpolicy&&(l.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?l.credentials="include":i.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(i){if(i.ep)return;i.ep=!0;const l=t(i);fetch(i.href,l)}};fe();var ie=11;function pe(r,e){var t=e.attributes,a,i,l,c,_;if(!(e.nodeType===ie||r.nodeType===ie)){for(var I=t.length-1;I>=0;I--)a=t[I],i=a.name,l=a.namespaceURI,c=a.value,l?(i=a.localName||i,_=r.getAttributeNS(l,i),_!==c&&(a.prefix==="xmlns"&&(i=a.name),r.setAttributeNS(l,i,c))):(_=r.getAttribute(i),_!==c&&r.setAttribute(i,c));for(var M=r.attributes,O=M.length-1;O>=0;O--)a=M[O],i=a.name,l=a.namespaceURI,l?(i=a.localName||i,e.hasAttributeNS(l,i)||r.removeAttributeNS(l,i)):e.hasAttribute(i)||r.removeAttribute(i)}}var F,he="http://www.w3.org/1999/xhtml",p=typeof document=="undefined"?void 0:document,ve=!!p&&"content"in p.createElement("template"),me=!!p&&p.createRange&&"createContextualFragment"in p.createRange();function ge(r){var e=p.createElement("template");return e.innerHTML=r,e.content.childNodes[0]}function be(r){F||(F=p.createRange(),F.selectNode(p.body));var e=F.createContextualFragment(r);return e.childNodes[0]}function ye(r){var e=p.createElement("body");return e.innerHTML=r,e.childNodes[0]}function xe(r){return r=r.trim(),ve?ge(r):me?be(r):ye(r)}function G(r,e){var t=r.nodeName,a=e.nodeName,i,l;return t===a?!0:(i=t.charCodeAt(0),l=a.charCodeAt(0),i<=90&&l>=97?t===a.toUpperCase():l<=90&&i>=97?a===t.toUpperCase():!1)}function Te(r,e){return!e||e===he?p.createElement(r):p.createElementNS(e,r)}function Ae(r,e){for(var t=r.firstChild;t;){var a=t.nextSibling;e.appendChild(t),t=a}return e}function W(r,e,t){r[t]!==e[t]&&(r[t]=e[t],r[t]?r.setAttribute(t,""):r.removeAttribute(t))}var ae={OPTION:function(r,e){var t=r.parentNode;if(t){var a=t.nodeName.toUpperCase();a==="OPTGROUP"&&(t=t.parentNode,a=t&&t.nodeName.toUpperCase()),a==="SELECT"&&!t.hasAttribute("multiple")&&(r.hasAttribute("selected")&&!e.selected&&(r.setAttribute("selected","selected"),r.removeAttribute("selected")),t.selectedIndex=-1)}W(r,e,"selected")},INPUT:function(r,e){W(r,e,"checked"),W(r,e,"disabled"),r.value!==e.value&&(r.value=e.value),e.hasAttribute("value")||r.removeAttribute("value")},TEXTAREA:function(r,e){var t=e.value;r.value!==t&&(r.value=t);var a=r.firstChild;if(a){var i=a.nodeValue;if(i==t||!t&&i==r.placeholder)return;a.nodeValue=t}},SELECT:function(r,e){if(!e.hasAttribute("multiple")){for(var t=-1,a=0,i=r.firstChild,l,c;i;)if(c=i.nodeName&&i.nodeName.toUpperCase(),c==="OPTGROUP")l=i,i=l.firstChild;else{if(c==="OPTION"){if(i.hasAttribute("selected")){t=a;break}a++}i=i.nextSibling,!i&&l&&(i=l.nextSibling,l=null)}r.selectedIndex=t}}},L=1,_e=11,ne=3,se=8;function A(){}function Se(r){if(r)return r.getAttribute&&r.getAttribute("id")||r.id}function we(r){return function(t,a,i){if(i||(i={}),typeof a=="string")if(t.nodeName==="#document"||t.nodeName==="HTML"||t.nodeName==="BODY"){var l=a;a=p.createElement("html"),a.innerHTML=l}else a=xe(a);var c=i.getNodeKey||Se,_=i.onBeforeNodeAdded||A,I=i.onNodeAdded||A,M=i.onBeforeElUpdated||A,O=i.onElUpdated||A,oe=i.onBeforeNodeDiscarded||A,P=i.onNodeDiscarded||A,le=i.onBeforeElChildrenUpdated||A,K=i.childrenOnly===!0,S=Object.create(null),R=[];function H(o){R.push(o)}function Z(o,s){if(o.nodeType===L)for(var n=o.firstChild;n;){var d=void 0;s&&(d=c(n))?H(d):(P(n),n.firstChild&&Z(n,s)),n=n.nextSibling}}function V(o,s,n){oe(o)!==!1&&(s&&s.removeChild(o),P(o),Z(o,n))}function ee(o){if(o.nodeType===L||o.nodeType===_e)for(var s=o.firstChild;s;){var n=c(s);n&&(S[n]=s),ee(s),s=s.nextSibling}}ee(t);function j(o){I(o);for(var s=o.firstChild;s;){var n=s.nextSibling,d=c(s);if(d){var v=S[d];v&&G(s,v)?(s.parentNode.replaceChild(v,s),C(v,s)):j(s)}else j(s);s=n}}function de(o,s,n){for(;s;){var d=s.nextSibling;(n=c(s))?H(n):V(s,o,!0),s=d}}function C(o,s,n){var d=c(s);d&&delete S[d],!(!n&&(M(o,s)===!1||(r(o,s),O(o),le(o,s)===!1)))&&(o.nodeName!=="TEXTAREA"?ce(o,s):ae.TEXTAREA(o,s))}function ce(o,s){var n=s.firstChild,d=o.firstChild,v,m,w,B,g;e:for(;n;){for(B=n.nextSibling,v=c(n);d;){if(w=d.nextSibling,n.isSameNode&&n.isSameNode(d)){n=B,d=w;continue e}m=c(d);var z=d.nodeType,b=void 0;if(z===n.nodeType&&(z===L?(v?v!==m&&((g=S[v])?w===g?b=!1:(o.insertBefore(g,d),m?H(m):V(d,o,!0),d=g):b=!1):m&&(b=!1),b=b!==!1&&G(d,n),b&&C(d,n)):(z===ne||z==se)&&(b=!0,d.nodeValue!==n.nodeValue&&(d.nodeValue=n.nodeValue))),b){n=B,d=w;continue e}m?H(m):V(d,o,!0),d=w}if(v&&(g=S[v])&&G(g,n))o.appendChild(g),C(g,n);else{var E=_(n);E!==!1&&(E&&(n=E),n.actualize&&(n=n.actualize(o.ownerDocument||p)),o.appendChild(n),j(n))}n=B,d=w}de(o,d,m);var re=ae[o.nodeName];re&&re(o,s)}var f=t,$=f.nodeType,te=a.nodeType;if(!K){if($===L)te===L?G(t,a)||(P(t),f=Ae(t,Te(a.nodeName,a.namespaceURI))):f=a;else if($===ne||$===se){if(te===$)return f.nodeValue!==a.nodeValue&&(f.nodeValue=a.nodeValue),f;f=a}}if(f===a)P(t);else{if(a.isSameNode&&a.isSameNode(f))return;if(C(f,a,K),R)for(var X=0,ue=R.length;X<ue;X++){var q=S[R[X]];q&&V(q,q.parentNode,!1)}}return!K&&f!==t&&t.parentNode&&(f.actualize&&(f=f.actualize(t.ownerDocument||p)),t.parentNode.replaceChild(f,t)),f}}var Ne=we(pe),y,U,D,Q;class ke{constructor(e,t,a){T(this,D);T(this,y,void 0);T(this,U,void 0);N(this,y,e),N(this,U,t),t.addEventListener("click",Y(this,D,Q).bind(this)),a.addEventListener("submit",Y(this,D,Q).bind(this))}render(){const e=document.createElement("div"),t=u(this,y).items.reduce((a,i)=>(a.push(`<li class="list__item">
          <input
            title="Mark done"
            class="list__item-checkbox"
            type="checkbox"
            name="${i.name}"
            id="${i.id}"
            ${i.completed?"checked":""}
          />
          <span class="list__item-text">${i.name}</span>
          <button
            title="Delete task"
            class="list__item-remove"
            data-task-id="${i.id}"
            type="button"
          ></button>
        </li>`),a),[]).join("");e.innerHTML=t,Ne(u(this,U).children[0],e)}}y=new WeakMap,U=new WeakMap,D=new WeakSet,Q=async function(e){try{e.type==="submit"?(e.preventDefault(),await u(this,y).addItem(new FormData(e.target).get("task-name")),e.target.reset(),this.render()):e.target.type==="checkbox"?await u(this,y).updateItem(e.target.id,{completed:e.target.checked}):e.target.type==="button"&&(await u(this,y).deleteItem(e.target.dataset.taskId),this.render())}catch(t){console.log(t)}};var k;class Ie{constructor(e){T(this,k,void 0);N(this,k,e)}get items(){var e;return(e=JSON.parse(localStorage.getItem(`${u(this,k)}`)))!=null?e:[]}saveItems(e){localStorage.setItem(`${u(this,k)}`,JSON.stringify(e))}}k=new WeakMap;var h,x;class Oe{constructor(){T(this,h,void 0);T(this,x,void 0);N(this,x,new Ie("tasks")),N(this,h,u(this,x).items)}get items(){return[...u(this,h)]}async addItem(e){if((e==null?void 0:e.length)<1)throw"Invalid name";u(this,h).push({id:`${crypto.randomUUID()}-${Date.now()}`,name:e,completed:!1}),setTimeout(()=>u(this,x).saveItems(u(this,h)),0)}async findItem(e){const t=u(this,h).findIndex(a=>a.id===e);if(t===-1)throw"Not found";return[t,u(this,h)[t]]}async updateItem(e,t){try{const[,a]=await this.findItem(e);for(const i in t)a[i]=t[i];setTimeout(()=>u(this,x).saveItems(u(this,h)),0)}catch(a){console.error(a)}}async deleteItem(e){try{const[t]=await this.findItem(e);u(this,h).splice(t,1),setTimeout(()=>u(this,x).saveItems(u(this,h)),0)}catch(t){console.error(t)}}}h=new WeakMap,x=new WeakMap;new ke(new Oe,document.querySelector(".js-task-list"),document.querySelector(".js-form")).render();
