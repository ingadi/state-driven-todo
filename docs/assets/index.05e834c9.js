var J=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)};var u=(i,e,t)=>(J(i,e,"read from private field"),t?t.call(i):e.get(i)),T=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},N=(i,e,t,r)=>(J(i,e,"write to private field"),r?r.call(i,t):e.set(i,t),t);var Y=(i,e,t)=>(J(i,e,"access private method"),t);const fe=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerpolicy&&(l.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?l.credentials="include":a.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}};fe();var re=11;function pe(i,e){var t=e.attributes,r,a,l,c,_;if(!(e.nodeType===re||i.nodeType===re)){for(var I=t.length-1;I>=0;I--)r=t[I],a=r.name,l=r.namespaceURI,c=r.value,l?(a=r.localName||a,_=i.getAttributeNS(l,a),_!==c&&(r.prefix==="xmlns"&&(a=r.name),i.setAttributeNS(l,a,c))):(_=i.getAttribute(a),_!==c&&i.setAttribute(a,c));for(var M=i.attributes,O=M.length-1;O>=0;O--)r=M[O],a=r.name,l=r.namespaceURI,l?(a=r.localName||a,e.hasAttributeNS(l,a)||i.removeAttributeNS(l,a)):e.hasAttribute(a)||i.removeAttribute(a)}}var F,he="http://www.w3.org/1999/xhtml",p=typeof document=="undefined"?void 0:document,ve=!!p&&"content"in p.createElement("template"),me=!!p&&p.createRange&&"createContextualFragment"in p.createRange();function ge(i){var e=p.createElement("template");return e.innerHTML=i,e.content.childNodes[0]}function be(i){F||(F=p.createRange(),F.selectNode(p.body));var e=F.createContextualFragment(i);return e.childNodes[0]}function ye(i){var e=p.createElement("body");return e.innerHTML=i,e.childNodes[0]}function xe(i){return i=i.trim(),ve?ge(i):me?be(i):ye(i)}function G(i,e){var t=i.nodeName,r=e.nodeName,a,l;return t===r?!0:(a=t.charCodeAt(0),l=r.charCodeAt(0),a<=90&&l>=97?t===r.toUpperCase():l<=90&&a>=97?r===t.toUpperCase():!1)}function Te(i,e){return!e||e===he?p.createElement(i):p.createElementNS(e,i)}function Ae(i,e){for(var t=i.firstChild;t;){var r=t.nextSibling;e.appendChild(t),t=r}return e}function W(i,e,t){i[t]!==e[t]&&(i[t]=e[t],i[t]?i.setAttribute(t,""):i.removeAttribute(t))}var ae={OPTION:function(i,e){var t=i.parentNode;if(t){var r=t.nodeName.toUpperCase();r==="OPTGROUP"&&(t=t.parentNode,r=t&&t.nodeName.toUpperCase()),r==="SELECT"&&!t.hasAttribute("multiple")&&(i.hasAttribute("selected")&&!e.selected&&(i.setAttribute("selected","selected"),i.removeAttribute("selected")),t.selectedIndex=-1)}W(i,e,"selected")},INPUT:function(i,e){W(i,e,"checked"),W(i,e,"disabled"),i.value!==e.value&&(i.value=e.value),e.hasAttribute("value")||i.removeAttribute("value")},TEXTAREA:function(i,e){var t=e.value;i.value!==t&&(i.value=t);var r=i.firstChild;if(r){var a=r.nodeValue;if(a==t||!t&&a==i.placeholder)return;r.nodeValue=t}},SELECT:function(i,e){if(!e.hasAttribute("multiple")){for(var t=-1,r=0,a=i.firstChild,l,c;a;)if(c=a.nodeName&&a.nodeName.toUpperCase(),c==="OPTGROUP")l=a,a=l.firstChild;else{if(c==="OPTION"){if(a.hasAttribute("selected")){t=r;break}r++}a=a.nextSibling,!a&&l&&(a=l.nextSibling,l=null)}i.selectedIndex=t}}},L=1,_e=11,ne=3,se=8;function A(){}function Se(i){if(i)return i.getAttribute&&i.getAttribute("id")||i.id}function we(i){return function(t,r,a){if(a||(a={}),typeof r=="string")if(t.nodeName==="#document"||t.nodeName==="HTML"||t.nodeName==="BODY"){var l=r;r=p.createElement("html"),r.innerHTML=l}else r=xe(r);var c=a.getNodeKey||Se,_=a.onBeforeNodeAdded||A,I=a.onNodeAdded||A,M=a.onBeforeElUpdated||A,O=a.onElUpdated||A,oe=a.onBeforeNodeDiscarded||A,P=a.onNodeDiscarded||A,le=a.onBeforeElChildrenUpdated||A,K=a.childrenOnly===!0,S=Object.create(null),R=[];function H(o){R.push(o)}function Z(o,s){if(o.nodeType===L)for(var n=o.firstChild;n;){var d=void 0;s&&(d=c(n))?H(d):(P(n),n.firstChild&&Z(n,s)),n=n.nextSibling}}function V(o,s,n){oe(o)!==!1&&(s&&s.removeChild(o),P(o),Z(o,n))}function ee(o){if(o.nodeType===L||o.nodeType===_e)for(var s=o.firstChild;s;){var n=c(s);n&&(S[n]=s),ee(s),s=s.nextSibling}}ee(t);function j(o){I(o);for(var s=o.firstChild;s;){var n=s.nextSibling,d=c(s);if(d){var v=S[d];v&&G(s,v)?(s.parentNode.replaceChild(v,s),C(v,s)):j(s)}else j(s);s=n}}function de(o,s,n){for(;s;){var d=s.nextSibling;(n=c(s))?H(n):V(s,o,!0),s=d}}function C(o,s,n){var d=c(s);d&&delete S[d],!(!n&&(M(o,s)===!1||(i(o,s),O(o),le(o,s)===!1)))&&(o.nodeName!=="TEXTAREA"?ce(o,s):ae.TEXTAREA(o,s))}function ce(o,s){var n=s.firstChild,d=o.firstChild,v,m,w,B,g;e:for(;n;){for(B=n.nextSibling,v=c(n);d;){if(w=d.nextSibling,n.isSameNode&&n.isSameNode(d)){n=B,d=w;continue e}m=c(d);var z=d.nodeType,b=void 0;if(z===n.nodeType&&(z===L?(v?v!==m&&((g=S[v])?w===g?b=!1:(o.insertBefore(g,d),m?H(m):V(d,o,!0),d=g):b=!1):m&&(b=!1),b=b!==!1&&G(d,n),b&&C(d,n)):(z===ne||z==se)&&(b=!0,d.nodeValue!==n.nodeValue&&(d.nodeValue=n.nodeValue))),b){n=B,d=w;continue e}m?H(m):V(d,o,!0),d=w}if(v&&(g=S[v])&&G(g,n))o.appendChild(g),C(g,n);else{var E=_(n);E!==!1&&(E&&(n=E),n.actualize&&(n=n.actualize(o.ownerDocument||p)),o.appendChild(n),j(n))}n=B,d=w}de(o,d,m);var ie=ae[o.nodeName];ie&&ie(o,s)}var f=t,$=f.nodeType,te=r.nodeType;if(!K){if($===L)te===L?G(t,r)||(P(t),f=Ae(t,Te(r.nodeName,r.namespaceURI))):f=r;else if($===ne||$===se){if(te===$)return f.nodeValue!==r.nodeValue&&(f.nodeValue=r.nodeValue),f;f=r}}if(f===r)P(t);else{if(r.isSameNode&&r.isSameNode(f))return;if(C(f,r,K),R)for(var X=0,ue=R.length;X<ue;X++){var q=S[R[X]];q&&V(q,q.parentNode,!1)}}return!K&&f!==t&&t.parentNode&&(f.actualize&&(f=f.actualize(t.ownerDocument||p)),t.parentNode.replaceChild(f,t)),f}}var Ne=we(pe),y,U,D,Q;class ke{constructor(e,t,r){T(this,D);T(this,y,void 0);T(this,U,void 0);N(this,y,e),N(this,U,t),t.addEventListener("click",Y(this,D,Q).bind(this)),r.addEventListener("submit",Y(this,D,Q).bind(this))}render(){const e=document.createElement("div"),t=u(this,y).items.map(r=>`<li class="list__item">
          <input
            title="Mark done"
            class="list__item-checkbox"
            type="checkbox"
            name="${r.name}"
            id="${r.id}"
            ${r.completed?"checked":""}
          />
          <span class="list__item-text">${r.name}</span>
          <button
            title="Delete task"
            class="list__item-remove"
            data-task-id="${r.id}"
            type="button"
          ></button>
        </li>`).join("");e.innerHTML=t,Ne(u(this,U).children[0],e)}}y=new WeakMap,U=new WeakMap,D=new WeakSet,Q=async function(e){try{e.type==="submit"?(e.preventDefault(),await u(this,y).addItem(new FormData(e.target).get("task-name")),e.target.reset(),this.render()):e.target.type==="checkbox"?await u(this,y).updateItem(e.target.id,{completed:e.target.checked}):e.target.type==="button"&&(await u(this,y).deleteItem(e.target.dataset.taskId),this.render())}catch(t){console.log(t)}};var k;class Ie{constructor(e){T(this,k,void 0);N(this,k,e)}get items(){var e;return(e=JSON.parse(localStorage.getItem(`${u(this,k)}`)))!=null?e:[]}saveItems(e){localStorage.setItem(`${u(this,k)}`,JSON.stringify(e))}}k=new WeakMap;var h,x;class Oe{constructor(){T(this,h,void 0);T(this,x,void 0);N(this,x,new Ie("tasks")),N(this,h,u(this,x).items)}get items(){return[...u(this,h)]}async addItem(e){if((e==null?void 0:e.length)<1)throw"Invalid name";u(this,h).push({id:`${crypto.randomUUID()}-${Date.now()}`,name:e,completed:!1}),setTimeout(()=>u(this,x).saveItems(u(this,h)),0)}async findItem(e){const t=u(this,h).findIndex(r=>r.id===e);if(t===-1)throw"Not found";return[t,u(this,h)[t]]}async updateItem(e,t){try{const[,r]=await this.findItem(e);for(const a in t)r[a]=t[a];setTimeout(()=>u(this,x).saveItems(u(this,h)),0)}catch(r){console.error(r)}}async deleteItem(e){try{const[t]=await this.findItem(e);u(this,h).splice(t,1),setTimeout(()=>u(this,x).saveItems(u(this,h)),0)}catch(t){console.error(t)}}}h=new WeakMap,x=new WeakMap;new ke(new Oe,document.querySelector(".js-task-list"),document.querySelector(".js-form")).render();
